<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mirsad Insights | Intelligence Platform</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.0.0"></script>
    <script src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js" defer></script>
    
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Noto+Sans+Arabic:wght@400;700&display=swap" rel="stylesheet">

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: { 
                        sans: ['Inter', 'sans-serif'],
                        arabic: ['Noto Sans Arabic', 'sans-serif']
                    },
                    colors: {
                        slate: {
                            850: '#1e293b',
                            900: '#0f172a',
                        },
                        brand: {
                            primary: '#3b82f6', // Owned / Blue
                            accent: '#8b5cf6',  // Earned / Purple
                            success: '#10b981', 
                            warning: '#f59e0b', 
                            danger: '#ef4444',  
                        }
                    }
                }
            }
        }
    </script>
    <style>
        .custom-scroll::-webkit-scrollbar { width: 6px; height: 6px; }
        .custom-scroll::-webkit-scrollbar-track { background: transparent; }
        .custom-scroll::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 4px; }
        .custom-scroll::-webkit-scrollbar-thumb:hover { background: #94a3b8; }
        [x-cloak] { display: none !important; }
        .chart-container { position: relative; height: 100%; width: 100%; }
    </style>
</head>

<body class="bg-slate-50 text-slate-800 font-sans antialiased h-screen overflow-hidden" 
      x-data="app()" 
      x-init="initCharts()">

    <div x-show="isLoading" x-transition.opacity 
         class="fixed inset-0 bg-slate-900/50 z-50 flex items-center justify-center backdrop-blur-sm" x-cloak>
        <div class="bg-white p-4 rounded-lg shadow-xl flex items-center space-x-3">
            <svg class="animate-spin h-6 w-6 text-brand-primary" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
            </svg>
            <span class="text-sm font-medium text-slate-700">Processing real-time signals...</span>
        </div>
    </div>

    <div x-show="toast.visible" x-transition:enter="transition ease-out duration-300" 
         x-transition:enter-start="translate-y-2 opacity-0" x-transition:enter-end="translate-y-0 opacity-100" 
         x-transition:leave="transition ease-in duration-300" x-transition:leave-start="opacity-100" 
         x-transition:leave-end="opacity-0" 
         class="fixed bottom-5 right-5 bg-slate-800 text-white px-4 py-3 rounded shadow-lg z-50 flex items-center space-x-2" x-cloak>
        <div class="w-2 h-2 rounded-full bg-green-400"></div>
        <span class="text-sm" x-text="toast.message"></span>
    </div>

    <div class="flex h-screen">
        
        <aside class="w-64 bg-slate-900 flex flex-col shadow-2xl z-20 flex-shrink-0 transition-all duration-300">
            <div class="h-16 flex items-center px-6 bg-slate-950 border-b border-slate-800">
                <div class="flex items-center space-x-2">
                    <div class="w-8 h-8 bg-brand-primary rounded flex items-center justify-center">
                        <svg class="w-5 h-5 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 012 2h2a2 2 0 012-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path></svg>
                    </div>
                    <div>
                        <h1 class="text-white font-bold text-lg tracking-tight leading-tight">Mirsad <span class="text-brand-primary font-light">Insights</span></h1>
                        <p class="text-[10px] text-slate-400 uppercase tracking-wider">Social Intelligence</p>
                    </div>
                </div>
            </div>

            <nav class="flex-1 px-3 py-6 space-y-1">
                <p class="px-3 text-[10px] font-bold text-slate-500 uppercase tracking-widest mb-2">Analytics</p>
                
                <a href="#" @click.prevent="switchTab('dashboard')" 
                   :class="currentTab === 'dashboard' ? 'bg-brand-primary text-white shadow-lg shadow-brand-primary/20' : 'text-slate-400 hover:text-white hover:bg-slate-800'"
                   class="group flex items-center px-3 py-2.5 rounded-lg transition-all duration-200">
                    <svg class="w-5 h-5 mr-3 transition-colors" :class="currentTab === 'dashboard' ? 'text-white' : 'text-slate-500 group-hover:text-white'" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"></path></svg>
                    Dashboard
                </a>

                <a href="#" @click.prevent="switchTab('mentions')" 
                   :class="currentTab === 'mentions' ? 'bg-brand-primary text-white shadow-lg shadow-brand-primary/20' : 'text-slate-400 hover:text-white hover:bg-slate-800'"
                   class="group flex items-center px-3 py-2.5 rounded-lg transition-all duration-200">
                    <svg class="w-5 h-5 mr-3 transition-colors" :class="currentTab === 'mentions' ? 'text-white' : 'text-slate-500 group-hover:text-white'" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"></path></svg>
                    Live Mentions
                    <span class="ml-auto bg-brand-danger text-white text-[10px] font-bold px-1.5 py-0.5 rounded-full">9+</span>
                </a>
                
                <a href="#" @click.prevent="switchTab('competitors')" 
                   :class="currentTab === 'competitors' ? 'bg-brand-primary text-white shadow-lg shadow-brand-primary/20' : 'text-slate-400 hover:text-white hover:bg-slate-800'"
                   class="group flex items-center px-3 py-2.5 rounded-lg transition-all duration-200">
                    <svg class="w-5 h-5 mr-3 transition-colors" :class="currentTab === 'competitors' ? 'text-white' : 'text-slate-500 group-hover:text-white'" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"></path></svg>
                    Competitor Analysis
                </a>

                <p class="px-3 text-[10px] font-bold text-slate-500 uppercase tracking-widest mt-6 mb-2">Reports</p>
                <a href="#" @click.prevent="simulateAction('Exporting Weekly Report...')" class="group flex items-center px-3 py-2.5 rounded-lg text-slate-400 hover:text-white hover:bg-slate-800 transition-all">
                    <svg class="w-5 h-5 mr-3 text-slate-500 group-hover:text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"></path></svg>
                    Export Data
                </a>
            </nav>

            <div class="p-4 border-t border-slate-800 bg-slate-950">
                <div class="flex items-center space-x-3">
                    <div class="w-9 h-9 rounded-full bg-gradient-to-tr from-blue-500 to-purple-500 border border-slate-600"></div>
                    <div>
                        <p class="text-sm font-bold text-white">Eyad Qunber</p>
                        <p class="text-xs text-slate-500">Mirsad Admin</p>
                    </div>
                </div>
            </div>
        </aside>

        <main class="flex-1 overflow-hidden relative flex flex-col">
            
            <header class="bg-white border-b border-slate-200 h-16 flex-shrink-0 flex items-center justify-between px-8 z-10">
                <div>
                    <h2 class="text-lg font-bold text-slate-800 flex items-center">
                        <span x-text="pageTitle[currentTab]"></span>
                        <span class="ml-3 text-[10px] bg-slate-100 text-slate-500 px-2 py-0.5 rounded border border-slate-200">LIVE</span>
                    </h2>
                </div>
                <div class="flex items-center space-x-4">
                    <div class="relative">
                        <input type="text" placeholder="Search topics..." class="pl-9 pr-4 py-1.5 text-sm border border-slate-300 rounded-md focus:outline-none focus:ring-2 focus:ring-brand-primary focus:border-transparent w-64">
                        <svg class="w-4 h-4 text-slate-400 absolute left-3 top-2.5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg>
                    </div>
                    <button @click="simulateAction('Refreshed Data Sources')" class="text-slate-500 hover:text-brand-primary transition p-2 rounded-full hover:bg-slate-50">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path></svg>
                    </button>
                    <button class="bg-slate-900 text-white text-xs font-semibold px-4 py-2 rounded shadow hover:bg-slate-800 transition">Settings</button>
                </div>
            </header>

            <div class="flex-1 overflow-y-auto custom-scroll p-8 bg-slate-50/50">
                
                <div x-show="currentTab === 'dashboard'" x-transition:enter="transition ease-out duration-300" x-transition:enter-start="opacity-0 scale-95" x-transition:enter-end="opacity-100 scale-100">
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-8">
                        <div class="bg-white p-5 rounded-xl border border-slate-200 shadow-sm relative overflow-hidden group hover:border-brand-primary/50 transition-all">
                            <div class="flex justify-between items-start mb-2">
                                <p class="text-xs font-bold text-slate-400 uppercase tracking-wide">Brand Sentiment</p>
                                <span class="bg-green-50 text-green-700 text-[10px] px-2 py-0.5 rounded-full font-bold border border-green-100">+12%</span>
                            </div>
                            <div class="relative h-20 w-full flex justify-center items-center">
                                <canvas id="bhiChart"></canvas>
                                <div class="absolute bottom-2 text-center">
                                    <span class="text-2xl font-bold text-slate-800">8.2</span>
                                    <span class="text-[10px] text-slate-400 block">Index Score</span>
                                </div>
                            </div>
                        </div>

                        <div class="bg-white p-5 rounded-xl border border-slate-200 shadow-sm group hover:border-brand-primary/50 transition-all">
                             <div class="flex justify-between items-start">
                                <p class="text-xs font-bold text-slate-400 uppercase tracking-wide">Total Mentions</p>
                                <svg class="w-4 h-4 text-brand-primary opacity-50" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 8h10M7 12h4m1 8l-4-4H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-3l-4 4z"></path></svg>
                            </div>
                            <h3 class="text-3xl font-bold text-slate-800 mt-2">318</h3>
                            <p class="text-xs text-green-600 mt-1 flex items-center font-medium">
                                <svg class="w-3 h-3 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"></path></svg>
                                45 vs last week
                            </p>
                        </div>

                        <div class="bg-white p-5 rounded-xl border border-slate-200 shadow-sm group hover:border-brand-primary/50 transition-all">
                             <div class="flex justify-between items-start">
                                <p class="text-xs font-bold text-slate-400 uppercase tracking-wide">Est. Reach</p>
                                <svg class="w-4 h-4 text-brand-primary opacity-50" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3.055 11H5a2 2 0 012 2v1a2 2 0 002 2 2 2 0 012 2v2.945M8 3.935V5.5A2.5 2.5 0 0010.5 8h.5a2 2 0 012 2 2 2 0 104 0 2 2 0 012-2h1.064M15 20.488V18a2 2 0 012-2h3.064M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                            </div>
                            <h3 class="text-3xl font-bold text-slate-800 mt-2">65.2K</h3>
                            <p class="text-xs text-slate-500 mt-1">Driven by viral video campaign</p>
                        </div>

                        <div class="bg-white p-5 rounded-xl border border-slate-200 shadow-sm group hover:border-brand-primary/50 transition-all">
                             <div class="flex justify-between items-start">
                                <p class="text-xs font-bold text-slate-400 uppercase tracking-wide">Share of Impressions</p>
                                <svg class="w-4 h-4 text-brand-primary opacity-50" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"></path></svg>
                            </div>
                            <h3 class="text-3xl font-bold text-slate-800 mt-2">1.4M</h3>
                            <p class="text-xs text-green-600 mt-1 font-medium">Dominant in sector (62%)</p>
                        </div>
                    </div>

                    <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 mb-6">
                        <div class="lg:col-span-2 bg-white p-6 rounded-xl border border-slate-200 shadow-sm">
                            <div class="flex justify-between items-center mb-6">
                                <div>
                                    <h3 class="font-bold text-slate-800 text-sm">Mention Velocity</h3>
                                    <p class="text-xs text-slate-400">Owned vs. Earned Media (Last 7 Days)</p>
                                </div>
                                <div class="flex items-center space-x-4 text-xs">
                                    <div class="flex items-center px-2 py-1 bg-blue-50 border border-blue-100 rounded"><span class="w-2 h-2 rounded-full bg-blue-500 mr-2"></span> Owned</div>
                                    <div class="flex items-center px-2 py-1 bg-purple-50 border border-purple-100 rounded"><span class="w-2 h-2 rounded-full bg-purple-500 mr-2"></span> Earned</div>
                                </div>
                            </div>
                            <div class="h-64 chart-container">
                                <canvas id="velocityChart"></canvas>
                            </div>
                        </div>

                        <div class="bg-white p-6 rounded-xl border border-slate-200 shadow-sm">
                            <h3 class="font-bold text-slate-800 text-sm mb-1">Sentiment by Platform</h3>
                            <p class="text-xs text-slate-400 mb-6">Positive vs Negative ratio</p>
                            <div class="h-64 chart-container">
                                <canvas id="platformSentimentChart"></canvas>
                            </div>
                        </div>
                    </div>

                    <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                        
                        <div class="lg:col-span-2 bg-white rounded-xl border border-slate-200 shadow-sm flex flex-col h-[500px]">
                            <div class="p-5 border-b border-slate-100 flex justify-between items-center bg-slate-50/50 rounded-t-xl">
                                <div>
                                    <h3 class="font-bold text-slate-800 text-sm">Mentions Stream</h3>
                                    <p class="text-[10px] text-slate-400">Context: KHCC & Healthcare</p>
                                </div>
                                <div class="flex space-x-2">
                                    <button @click="filter = 'all'" :class="filter === 'all' ? 'bg-slate-800 text-white' : 'bg-white text-slate-600 border border-slate-200'" class="px-3 py-1 text-[10px] font-medium rounded transition">All</button>
                                    <button @click="filter = 'negative'" :class="filter === 'negative' ? 'bg-red-500 text-white' : 'bg-white text-slate-600 border border-slate-200'" class="px-3 py-1 text-[10px] font-medium rounded transition">Risks</button>
                                </div>
                            </div>
                            
                            <div class="flex-1 overflow-y-auto custom-scroll p-4 space-y-3 bg-slate-50">
                                <template x-for="post in filteredPosts" :key="post.id">
                                    <div class="bg-white p-4 rounded-lg border border-slate-200 shadow-sm hover:shadow-md transition-all cursor-pointer group">
                                        <div class="flex justify-between items-start">
                                            <div class="flex items-center space-x-3">
                                                <div class="w-8 h-8 rounded-full flex items-center justify-center shrink-0" :class="getSourceClass(post.source)" x-html="getSourceIcon(post.source)"></div>
                                                <div>
                                                    <div class="flex items-center space-x-2">
                                                        <span class="text-xs font-bold text-slate-900" x-text="post.user"></span>
                                                        <span class="text-[10px] text-slate-400" x-text="post.handle"></span>
                                                    </div>
                                                    <div class="text-[10px] text-slate-400" x-text="post.date"></div>
                                                </div>
                                            </div>
                                            <span class="px-2 py-0.5 rounded text-[9px] font-bold uppercase tracking-wide border" 
                                                :class="{
                                                    'bg-green-50 text-green-600 border-green-100': post.sentiment === 'positive',
                                                    'bg-red-50 text-red-600 border-red-100': post.sentiment === 'negative',
                                                    'bg-slate-50 text-slate-500 border-slate-200': post.sentiment === 'neutral'
                                                }" 
                                                x-text="post.sentiment">
                                            </span>
                                        </div>
                                        <p class="mt-3 text-sm text-slate-600 font-arabic leading-relaxed" x-html="post.content"></p>
                                        <div class="mt-3 flex items-center space-x-4 text-[10px] text-slate-400 border-t border-slate-50 pt-2 group-hover:border-slate-100 transition-colors">
                                            <span class="flex items-center"><svg class="w-3 h-3 mr-1" fill="currentColor" viewBox="0 0 20 20"><path d="M2 10.5a1.5 1.5 0 113 0v6a1.5 1.5 0 01-3 0v-6zM6 10.333v5.43a2 2 0 001.106 1.79l.05.025A4 4 0 008.943 18h5.416a2 2 0 001.962-1.608l1.2-6A2 2 0 0015.56 8H12V4a2 2 0 00-2-2 1 1 0 00-1 1v7.333z"/></svg> <span x-text="post.likes"></span></span>
                                            <span class="flex items-center"><svg class="w-3 h-3 mr-1" fill="currentColor" viewBox="0 0 20 20"><path d="M15 8a3 3 0 10-2.977-2.63l-4.94 2.47a3 3 0 100 4.319l4.94 2.47a3 3 0 10.895-1.789l-4.94-2.47a3.027 3.027 0 000-.74l4.94-2.47C13.456 7.68 14.19 8 15 8z"/></svg> <span x-text="post.shares"></span></span>
                                            <span class="ml-auto font-medium text-brand-primary" x-text="post.engagement"></span>
                                        </div>
                                    </div>
                                </template>
                            </div>
                        </div>

                        <div class="space-y-6">
                            <div class="bg-white p-6 rounded-xl border border-slate-200 shadow-sm">
                                <h3 class="font-bold text-slate-800 text-sm mb-4">Audience Demographics</h3>
                                <div class="h-48 chart-container flex justify-center">
                                    <canvas id="demoChart"></canvas>
                                </div>
                                <div class="mt-4 flex justify-center space-x-4">
                                    <div class="flex items-center"><span class="w-2 h-2 bg-pink-500 rounded-full mr-1.5"></span><span class="text-xs font-bold text-slate-600">Female (68%)</span></div>
                                    <div class="flex items-center"><span class="w-2 h-2 bg-blue-500 rounded-full mr-1.5"></span><span class="text-xs font-bold text-slate-600">Male (32%)</span></div>
                                </div>
                            </div>

                            <div class="bg-white p-6 rounded-xl border border-slate-200 shadow-sm">
                                <h3 class="font-bold text-slate-800 text-sm mb-4">Top Sources</h3>
                                <div class="h-40 chart-container">
                                    <canvas id="sourceChart"></canvas>
                                </div>
                            </div>
                        </div>

                    </div>
                </div>

                <div x-show="currentTab === 'mentions'" x-cloak>
                    <div class="bg-white rounded-xl border border-slate-200 shadow-sm p-8 text-center py-20">
                        <div class="inline-block p-4 rounded-full bg-slate-100 mb-4">
                            <svg class="w-8 h-8 text-slate-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"></path></svg>
                        </div>
                        <h3 class="text-xl font-bold text-slate-800">Advanced Filtering View</h3>
                        <p class="text-slate-500 mt-2 mb-6">This module connects to the real-time Firehose API. Use the filter bar to drill down.</p>
                        <button @click="switchTab('dashboard')" class="text-brand-primary font-bold hover:underline">Back to Dashboard</button>
                    </div>
                </div>
                 <div x-show="currentTab === 'competitors'" x-cloak>
                    <div class="bg-white rounded-xl border border-slate-200 shadow-sm p-8 text-center py-20">
                        <div class="inline-block p-4 rounded-full bg-slate-100 mb-4">
                            <svg class="w-8 h-8 text-slate-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 012 2h2a2 2 0 012-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path></svg>
                        </div>
                        <h3 class="text-xl font-bold text-slate-800">Competitor Benchmarking</h3>
                        <p class="text-slate-500 mt-2">Compare Share of Voice against local market leaders.</p>
                    </div>
                </div>

            </div>
        </main>
    </div>

    <script>
        function app() {
            return {
                currentTab: 'dashboard',
                filter: 'all',
                isLoading: false,
                toast: { visible: false, message: '' },
                pageTitle: {
                    dashboard: 'Brand Health Overview',
                    mentions: 'Mentions Explorer',
                    competitors: 'Competitor Landscape'
                },
                posts: [
                    { 
                        id: 1, 
                        source: 'facebook', 
                        user: 'KHCF & KHCC', 
                        handle: '@KHCFKHCC', 
                        date: '2h ago', 
                        content: "ÿ•ÿ®ÿ±ÿßŸáŸäŸÖ ÿßŸÑÿ®ÿ∑ŸÑ ÿÆŸÑŸëÿµ ÿ¢ÿÆÿ± ÿ¨ÿ±ÿπÿ© ŸÉŸäŸÖÿßŸàŸä... ÿßŸÑÿ®ÿ∑ŸÑ ÿßŸÑÿµÿ∫Ÿäÿ± ÿπŸÑŸëŸÖŸÜÿß ÿ¥Ÿà ŸäÿπŸÜŸä ÿ¥ÿ¨ÿßÿπÿ©. ÿ£ŸÑŸÅ ÿßŸÑÿ≠ŸÖÿØŸÑŸÑŸá ÿπŸÑŸâ ÿßŸÑÿ≥ŸÑÿßŸÖÿ© üîîüíõ <span class='block mt-2 text-brand-primary'>#SuccessStory #Hope</span>", 
                        sentiment: 'positive', engagement: 'High', likes: '777', shares: '209' 
                    },
                    { 
                        id: 2, 
                        source: 'twitter', 
                        user: 'Muna AbuSulayman', 
                        handle: '@abusulayman', 
                        date: '4h ago', 
                        content: "ÿ≥ÿπÿØÿ™ ÿ®ÿØÿπŸàÿ™Ÿä ŸÑÿ≤Ÿäÿßÿ±ÿ© <span class='font-bold text-slate-900'>ŸÖÿ±ŸÉÿ≤ ÿßŸÑÿ≠ÿ≥ŸäŸÜ ŸÑŸÑÿ≥ÿ±ÿ∑ÿßŸÜ</span>. ŸÅÿÆŸàÿ±ÿ© ÿ®Ÿàÿ¨ŸàÿØ Ÿáÿ∞ÿß ÿßŸÑÿµÿ±ÿ≠ ÿßŸÑÿ∑ÿ®Ÿä ÿßŸÑŸÖÿ™ŸÖŸäÿ≤ ŸÅŸä ÿπÿßŸÑŸÖŸÜÿß ÿßŸÑÿπÿ±ÿ®Ÿä. üáØüá¥", 
                        sentiment: 'positive', engagement: 'Viral', likes: '1.2k', shares: '20.7k' 
                    },
                    { 
                        id: 3, 
                        source: 'facebook', 
                        user: 'Naser Q. Qaqish', 
                        handle: 'Top Fan', 
                        date: '6h ago', 
                        content: "ÿπŸÜÿØŸä ÿßÿ≥ÿ™ŸÅÿ≥ÿßÿ± ÿ®ÿÆÿµŸàÿµ ÿ™ÿ¨ÿØŸäÿØ ÿßŸÑÿ•ÿπŸÅÿßÿ°ÿå ÿßŸÑŸÖŸàŸÇÿπ ÿßŸÑÿßŸÑŸÉÿ™ÿ±ŸàŸÜŸä ŸÖÿß ÿπŸÖ ÿ®ŸÅÿ™ÿ≠ ŸÖÿπŸä ŸÖŸÜ ÿßŸÑÿµÿ®ÿ≠. Ÿäÿ±ÿ¨Ÿâ ÿßŸÑŸÖÿ≥ÿßÿπÿØÿ©. <span class='font-bold text-slate-900'>#Help</span>", 
                        sentiment: 'negative', engagement: 'Medium', likes: '45', shares: '12' 
                    },
                    { 
                        id: 4, 
                        source: 'web', 
                        user: 'Al Mamlaka TV', 
                        handle: 'News Source', 
                        date: '1d ago', 
                        content: "ÿ•ÿ∑ŸÑÿßŸÇ ŸÖÿ®ÿßÿØÿ±ÿ© ÿ¨ÿØŸäÿØÿ© ŸÑÿØÿπŸÖ ÿßŸÑÿµÿ≠ÿ© ÿßŸÑŸÜŸÅÿ≥Ÿäÿ© ŸÑŸÖÿ±ÿ∂Ÿâ ÿßŸÑÿ≥ÿ±ÿ∑ÿßŸÜ ŸÅŸä ÿßŸÑÿ£ÿ±ÿØŸÜ.", 
                        sentiment: 'neutral', engagement: 'Medium', likes: '890', shares: '1.2k' 
                    },
                    { 
                        id: 5, 
                        source: 'twitter', 
                        user: 'AraBella', 
                        handle: '@AraBellaa_962', 
                        date: '1d ago', 
                        content: "ÿ®ÿ£ŸäÿØŸä ŸàÿπŸÇŸàŸÑ ÿ£ÿ±ÿØŸÜŸäÿ©ÿå ŸÖÿ±ŸÉÿ≤ ÿßŸÑÿ≠ÿ≥ŸäŸÜ Ÿäÿ¨ÿ±Ÿä ÿ£ŸàŸÑ ÿπŸÖŸÑŸäÿ© ŸÜŸàÿπŸäÿ© ŸÑÿ£Ÿàÿ±ÿßŸÖ ÿßŸÑÿØŸÖÿßÿ∫ ÿ®ÿßÿ≥ÿ™ÿÆÿØÿßŸÖ ÿßŸÑŸÑŸäÿ≤ÿ± ŸàÿßŸÑÿ±Ÿàÿ®Ÿàÿ™. üß†ü§ñ ÿ•ŸÜÿ¨ÿßÿ≤ ÿπÿ∏ŸäŸÖ!", 
                        sentiment: 'positive', engagement: 'High', likes: '2.1k', shares: '540' 
                    }
                ],
                get filteredPosts() { 
                    return this.filter === 'all' ? this.posts : this.posts.filter(p => p.sentiment === this.filter);
                },
                switchTab(tab) {
                    this.isLoading = true;
                    setTimeout(() => {
                        this.currentTab = tab;
                        this.isLoading = false;
                    }, 600); // Simulate network latency
                },
                simulateAction(msg) {
                    this.isLoading = true;
                    setTimeout(() => {
                        this.isLoading = false;
                        this.showToast(msg);
                    }, 1200);
                },
                showToast(message) {
                    this.toast.message = message;
                    this.toast.visible = true;
                    setTimeout(() => { this.toast.visible = false; }, 3000);
                },
                getSourceIcon(source) {
                    const icons = {
                        twitter: '<svg class="w-4 h-4 text-white" fill="currentColor" viewBox="0 0 24 24"><path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/></svg>',
                        facebook: '<svg class="w-4 h-4 text-white" fill="currentColor" viewBox="0 0 24 24"><path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"/></svg>',
                        web: '<svg class="w-4 h-4 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 12a9 9 0 01-9 9m9-9a9 9 0 00-9-9m9 9H3m9 9a9 9 0 01-9-9m9 9c1.657 0 3-4.03 3-9s-1.343-9-3-9m0 18c-1.657 0-3-4.03-3-9s1.343-9 3-9m-9 9a9 9 0 019-9"/></svg>'
                    };
                    return icons[source] || icons.web;
                },
                getSourceClass(source) {
                    const classes = { twitter: 'bg-black', facebook: 'bg-blue-600', web: 'bg-slate-400' };
                    return classes[source] || 'bg-slate-400';
                },
                initCharts() {
                    // Logic handled in separate script tag below
                }
            }
        }
    </script>

    <script>
        // CHART INITIALIZATION
        document.addEventListener('alpine:init', () => {
            Chart.defaults.font.family = "'Inter', sans-serif";
            Chart.defaults.color = '#64748b';
            
            // 1. GAUGE NEEDLE PLUGIN
            const gaugeNeedle = {
                id: 'gaugeNeedle',
                afterDatasetDraw(chart) {
                    const { ctx, chartArea: { width, height } } = chart;
                    ctx.save();
                    const value = 0.8; 
                    const angle = Math.PI + (Math.PI * value);
                    const cx = width / 2;
                    const cy = height - 6;

                    ctx.translate(cx, cy);
                    ctx.rotate(angle);
                    ctx.beginPath();
                    ctx.moveTo(0, -3);
                    ctx.lineTo(height - 25, 0);
                    ctx.lineTo(0, 3);
                    ctx.fillStyle = '#1e293b';
                    ctx.fill();
                    ctx.restore();
                    
                    ctx.beginPath();
                    ctx.arc(cx, cy, 4, 0, 10);
                    ctx.fillStyle = '#1e293b';
                    ctx.fill();
                }
            };

            // BHI Chart
            new Chart(document.getElementById('bhiChart'), {
                type: 'doughnut',
                data: {
                    labels: ['Bad', 'Average', 'Good', 'Excellent'],
                    datasets: [{
                        data: [20, 20, 20, 40],
                        backgroundColor: ['#ef4444', '#f59e0b', '#3b82f6', '#10b981'],
                        borderWidth: 0,
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    rotation: -90,
                    circumference: 180,
                    cutout: '80%',
                    plugins: { legend: { display: false }, tooltip: { enabled: false }, datalabels: { display: false } }
                },
                plugins: [gaugeNeedle]
            });

            // Velocity Chart (UPDATED: Owned vs Earned)
            const ctxV = document.getElementById('velocityChart').getContext('2d');
            
            // Gradients
            const gradOwned = ctxV.createLinearGradient(0, 0, 0, 300);
            gradOwned.addColorStop(0, 'rgba(59, 130, 246, 0.2)');
            gradOwned.addColorStop(1, 'rgba(59, 130, 246, 0)');

            const gradEarned = ctxV.createLinearGradient(0, 0, 0, 300);
            gradEarned.addColorStop(0, 'rgba(139, 92, 246, 0.2)');
            gradEarned.addColorStop(1, 'rgba(139, 92, 246, 0)');

            new Chart(ctxV, {
                type: 'line',
                data: {
                    labels: ['Dec 06', 'Dec 07', 'Dec 08', 'Dec 09', 'Dec 10', 'Dec 11', 'Dec 12'],
                    datasets: [
                        { 
                            label: 'Owned', 
                            data: [120, 150, 450, 200, 300, 400, 350], 
                            borderColor: '#3b82f6', 
                            backgroundColor: gradOwned, 
                            fill: true, 
                            tension: 0.4, 
                            borderWidth: 2,
                            pointRadius: 0,
                            pointHoverRadius: 4
                        },
                        { 
                            label: 'Earned', 
                            data: [200, 250, 300, 280, 320, 1400, 1200], // Simulating the viral spike
                            borderColor: '#8b5cf6', 
                            backgroundColor: gradEarned, 
                            fill: true, 
                            tension: 0.4, 
                            borderWidth: 2,
                            pointRadius: 0,
                            pointHoverRadius: 4
                        }
                    ]
                },
                options: { 
                    responsive: true, 
                    maintainAspectRatio: false,
                    plugins: { legend: { display: false }, datalabels: { display: false } },
                    scales: { x: { grid: { display: false } }, y: { grid: { borderDash: [4, 4] } } },
                    interaction: { mode: 'index', intersect: false }
                }
            });

            // Sentiment Bar
            new Chart(document.getElementById('platformSentimentChart'), {
                type: 'bar',
                data: {
                    labels: ['Facebook', 'Twitter', 'Instagram', 'Web'],
                    datasets: [
                        { label: 'Positive', data: [65, 40, 80, 20], backgroundColor: '#10b981', stack: 'Stack 0', barThickness: 20 },
                        { label: 'Negative', data: [15, 30, 5, 5], backgroundColor: '#ef4444', stack: 'Stack 0', barThickness: 20 },
                        { label: 'Neutral', data: [20, 30, 15, 75], backgroundColor: '#e2e8f0', stack: 'Stack 0', barThickness: 20 }
                    ]
                },
                options: { 
                    responsive: true, 
                    maintainAspectRatio: false,
                    scales: { x: { grid: { display: false } }, y: { display: false, stacked: true } },
                    plugins: { legend: { position: 'bottom', labels: { boxWidth: 10, usePointStyle: true } }, datalabels: { display: false } }
                }
            });

            // Demographics
            new Chart(document.getElementById('demoChart'), {
                type: 'doughnut',
                data: { 
                    labels: ['Female', 'Male'], 
                    datasets: [{ data: [68, 32], backgroundColor: ['#ec4899', '#3b82f6'], borderWidth: 0 }] 
                },
                options: { 
                    responsive: true, 
                    maintainAspectRatio: false, 
                    cutout: '70%', 
                    plugins: { legend: { display: false }, datalabels: { color: 'white', font: { weight: 'bold' } } } 
                }
            });

            // Sources (UPDATED: Custom Colored Legend)
            new Chart(document.getElementById('sourceChart'), {
                type: 'bar',
                indexAxis: 'y',
                data: {
                    labels: ['Facebook', 'Twitter/X', 'Instagram', 'Web'],
                    datasets: [{ 
                        // Note: Label removed here as we generate custom legend below
                        data: [65, 25, 8, 2], 
                        backgroundColor: ['#1877F2', '#000000', '#E4405F', '#64748b'], 
                        borderRadius: 4, 
                        barThickness: 12 
                    }]
                },
                options: { 
                    responsive: true, 
                    maintainAspectRatio: false, 
                    plugins: { 
                        legend: { 
                            display: true, 
                            position: 'bottom', 
                            labels: { 
                                usePointStyle: true, 
                                boxWidth: 8, 
                                font: { size: 10 },
                                // This function creates a legend item for every BAR, not just the dataset
                                generateLabels: (chart) => {
                                    const data = chart.data;
                                    return data.labels.map((label, i) => ({
                                        text: label,
                                        fillStyle: data.datasets[0].backgroundColor[i],
                                        strokeStyle: data.datasets[0].backgroundColor[i],
                                        hidden: false,
                                        index: i
                                    }));
                                }
                            },
                            // Disable default click behavior (hiding bars) since it's one dataset
                            onClick: null 
                        }, 
                        datalabels: { 
                            anchor: 'end', 
                            align: 'end', 
                            color: '#64748b', 
                            formatter: v => v + '%' 
                        } 
                    },
                    scales: { 
                        x: { 
                            display: true, 
                            grid: { color: '#f1f5f9' }, 
                            ticks: { display: false } 
                        }, 
                        y: { 
                            grid: { display: false } 
                        } 
                    }
                }
            });
        });
    </script>
</body>
</html>
